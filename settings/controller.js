define("settings/../template/list",["util"],function(require){var T=(require("util"),{html:function($data){var __="";with($data||{})__+='<div class="main"><h1 sn-binding="html:title"></h1> <div class="toolbar"> <b class="button" sn-repeat="button in toolbar" sn-on="click:button.click"> <em sn-binding="class:button.ico"></em><text sn-binding="html:button.value"></text> </b> </div> <div class="action"></div> </div> ';return __},helpers:{}});return T.template=T.html,T});define("settings/../template/form",["util"],function(require){var T=(require("util"),{html:function($data){var __="";with($data||{})__+='<div class="main"> <h1 sn-binding="html:title"></h1> <div class="action"> <b class="button" sn-repeat="button in buttons" sn-on="click:button.click"> <em sn-binding="class:button.ico"></em><text sn-binding="html:button.value"></text> </b> </div> </div> ';return __},helpers:{}});return T.template=T.html,T});define("settings/views/ad_list",["images/style.css","settings/data","$","util","core/model","common/page","common/menu","components/form","components/grid","settings/data/adtypes"],function(t,e,i){var n=t("$"),s=t("util"),a=t("core/model"),l=t("common/page"),o=t("common/menu"),d=(t("components/form"),t("components/grid")),c=t("settings/data/adtypes");return l.extend({events:{"click .js_grid_delete":function(t){var e=t.currentTarget.getAttribute("data-id"),i=this;window.confirm("确认删除？")&&n.post("/api/manage/delete_ad",{id:e},function(t){t.success?i.grid.load():sl.tip(t.msg)},"json")},"click .js_click":function(t){var e=t.currentTarget.getAttribute("data-id"),i=t.currentTarget.getAttribute("data-url");s.store("current_ad",s.first(this.grid.data(),function(t){return t.ID==e})),this.forward(i)}},onCreate:function(){var t=this;this.model=new a.ViewModel(this.$el,{title:"广告位管理"}),this.onResult("ad_change",function(){this.grid.load()}),this.grid=new d({search:{url:"/api/settings/ad_list",type:"GET",beforeSend:function(){},data:{name:{label:"广告位置",type:"select",options:c}}},onSelectRow:function(){},columns:[{text:"编号",bind:"ID",width:5},{text:"广告名称",bind:"Title",width:10},{text:"广告图片",bind:"Src",width:10,render:function(t){this.append('<a href="'+t.Src+'" target="_blank">'+t.Src+"</a>")}},{text:"操作",width:10,align:"center",valign:"center",render:function(e){this.append(n('<a href="javascript:;" class="js_click" data-id="'+e.ID+'" data-url="/settings/modify_ad/'+t.$('[name="name"]').val()+"/"+e.ID+'">[修改]</a>')),this.append(' <a href="javascript:;" data-id="'+e.ID+'" class="js_grid_delete">[删除]</a>')}}]}).search(),this.$el.find(".toolbar").after(this.grid.$el)},onShow:function(){this.menu=o.get("/"),this.$el.before(this.menu.$el)},onDestory:function(){}})});define("settings/views/add_ad",["images/style.css","settings/data","$","util","core/model","common/page","common/menu","components/form","settings/data/adtypes"],function(e,t,i){var o=(e("$"),e("util"),e("core/model")),a=e("common/page"),l=e("common/menu"),r=e("components/form"),c=e("settings/data/adtypes");return a.extend({events:{},onCreate:function(){var e=this;this.model=new o.ViewModel(this.$el,{title:"添加广告",buttons:[{value:"确认",click:function(){t.submit(function(i){i.success?(sl.tip("添加成功"),e.setResult("ad_change"),e.back("/settings/ad_list"),t.reset()):sl.tip(i.msg)})}},{value:"重置",click:function(){t.reset()}}]});var t=new r({model:this.model,name:"user",title:"test",useIframe:!0,url:"/api/manage/add_ad",validator:"userValid",enctype:"",fields:[{label:"广告位置",field:"Name",type:"select",emptyAble:!0,options:{data:c}},{label:"广告标题",field:"Title",emptyAble:!1,emptyText:"必填"},{label:"广告链接",field:"Url",emptyAble:!1,emptyText:"必填"},{label:"广告图片",field:"Src",type:"file",emptyAble:!1,emptyText:"不可为空"},{label:"广告详情",field:"Description",vAlign:"top",type:"richTextBox"},{label:"广告详情",field:"Sort",type:"number",label:"排序"}]});this.model.before(".action",t.$el)},onShow:function(){this.menu=l.get(this.route.path),this.$el.before(this.menu.$el)},onDestory:function(){}})});define("settings/views/modify_ad",["images/style.css","settings/data","$","util","core/model","common/page","common/menu","components/form","settings/data/adtypes"],function(e,t,i){var s=(e("$"),e("util")),o=e("core/model"),a=e("common/page"),l=e("common/menu"),r=e("components/form"),c=e("settings/data/adtypes");return a.extend({events:{},onCreate:function(){var e=this;this.model=new o.ViewModel(this.$el,{title:"修改目的地",buttons:[{value:"确认",click:function(){t.submit(function(t){t.success?(sl.tip("修改成功"),e.setResult("destination_change"),e.back("/"),e.form.reset()):sl.tip(t.msg)})}}]}),e.model.set("data",s.store("current_ad"));var t=new r({model:this.model,name:"data",title:"test",useIframe:!0,url:"/api/manage/modify_ad",validator:"userValid",enctype:"",fields:[{field:"ID",type:"hidden"},{label:"广告位置",field:"Name",type:"select",emptyAble:!0,options:{data:c}},{label:"广告标题",field:"Title",emptyAble:!1,emptyText:"必填"},{label:"广告链接",field:"Url",emptyAble:!1,emptyText:"必填"},{label:"广告图片",field:"Src",type:"file",emptyAble:!1,emptyText:"不可为空"},{label:"广告详情",field:"Description",vAlign:"top",type:"richTextBox"},{label:"广告详情",field:"Sort",type:"number",label:"排序"}]});this.model.before(".action",t.$el)},onShow:function(){this.menu=l.get(this.route.path),this.$el.before(this.menu.$el)},onDestory:function(){}})});